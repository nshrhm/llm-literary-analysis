# 結果フォーマットの仕様

## 評価項目

実験結果は以下の4つの感情に対する数値評価（0-100）と理由を含みます：

- 面白さ (Interesting/Fun)
- 驚き (Surprise)
- 悲しみ (Sadness)
- 怒り (Anger)

## フォーマット構造

結果は質問番号とラベルを明確に示す形式で記録されます：

```
timestamp: [YYYY-MM-DD HH:MM:SS]
persona: [ペルソナ名]
model: [モデル名]
trial: [試行番号]
temperature: [温度値 or None（推論モデルの場合）]  # 2025-03-27更新
text: [テキスト名]

Q1. 面白さ(数値): [0-100]
Q1. 面白さ(理由): [explanation]

Q2. 驚き(数値): [0-100]
Q2. 驚き(理由): [explanation]

Q3. 悲しみ(数値): [0-100]
Q3. 悲しみ(理由): [explanation]

Q4. 怒り(数値): [0-100]
Q4. 怒り(理由): [explanation]
```

## 評価基準

- 数値評価（0-100）
  - 0: 全く感じない
  - 50: 中程度
  - 100: 非常に強く感じる
- 理由の説明は日本語で記述
- 各評価に対して具体的な根拠を提供

## メタデータ処理

### 温度パラメータの扱い（2025-03-27更新）
1. 推論モデル（o3-mini、o1-mini）
   - temperature: None を明示的に記録
   - ファイル名から温度パラメータを省略

2. 生成モデル
   - temperature: [0.0-1.0] の実数値を記録
   - ファイル名に温度パラメータを含める

### ファイル命名規則
- 標準形式：`p{persona}_{model}_n{trial}_temp{temp}_{text}.txt`
- 推論モデル：`p{persona}_{model}_n{trial}_{text}.txt`

### メタデータの検証
- タイムスタンプのフォーマット確認
- ペルソナIDの範囲チェック（p1-p4）
- モデル名の正規化
- 試行番号の形式（n01-n10）
- テキストIDの範囲（t1-t3）

## 結果の検証

### 数値評価
- 範囲チェック（0-100）
- 整数値であることの確認
- 欠損値のチェック

### 理由の説明
- 日本語テキストの存在確認
- 文字エンコーディングの検証
- 最小文字数のチェック

### フォーマット整合性
- 必須フィールドの存在確認
- フィールド順序の検証
- 空行の適切な配置

## エラー処理

### メタデータエラー
1. タイムスタンプ
   - 不正なフォーマット
   - 未来の日時
   - タイムゾーンの不一致

2. モデル情報
   - 未知のモデル識別子
   - 不正な温度値
   - モデルと温度の不整合

### 評価データエラー
1. 数値評価
   - 範囲外の値
   - 非整数値
   - 欠損データ

2. 理由の説明
   - 空の説明
   - 文字化けテキスト
   - 言語の不一致

## 集計処理

### データ変換
1. メタデータの正規化
   - モデル名の標準化
   - タイムスタンプの統一
   - 温度値の形式統一

2. 評価データの処理
   - 数値のキャスト
   - テキストのクリーニング
   - 欠損値の処理

### 集計ルール
1. グループ化基準
   - モデル別
   - ペルソナ別
   - テキスト別

2. 統計計算
   - 平均値と標準偏差
   - 最小値と最大値
   - 分布の分析
